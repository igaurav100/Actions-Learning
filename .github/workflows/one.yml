name: terraform

on:
    workflow_dispatch:
      
    # push:
    #     branches:
    #         - main
    # pull_request: 
    #     branches: 
    #         - main

env:
    TF_VERSION: 1.5.0

jobs:
    terraform:
        name: Terraform
        runs-on: ubuntu-latest

        permissions: 
            contents: read # Allows the workflow to read repository contents, necessary for actions/checkout@v3 to function properly
            id-token: write # Scoped 'id-token: write' permission for Checkov action
            
        steps:
        - name: Checkout code
          uses: actions/checkout@v3

        - name: checking the PWD
          run: |
            pwd
            ls -la
            cat index.html

        - name: changing the directory # This step changes the working directory to 'projectfile' and lists its contents, then reads the contents of file1.txt and file2.txt for this step
          working-directory: ./projectfile
          run: |
            pwd
            ls -la
            cat file1.txt
            cat file2.txt

        - name: checking pwd again
          run: |
            pwd
            ls -la
            echo "terraform version is $TF_VERSION"
            
        - name: Test with checkov
          uses: bridgecrewio/checkov-action@master
          with:
            # checkov_version: ${{ env.CK_VERSION }}
            directory: ./projectfile
          
          
        - name: Check checkov version
          run: checkov --version